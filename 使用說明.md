# 🍗 Bookbar 營業對帳系統使用說明

## 🌐 網頁介面使用方式

### 方法一：使用啟動腳本（推薦）
```bash
python start_web.py
```
這個腳本會：
- 自動檢查必要檔案
- 啟動網頁服務
- 自動開啟瀏覽器
- 顯示使用說明

### 方法二：手動啟動
```bash
python web_interface.py
```
然後在瀏覽器中開啟：http://localhost:8080

## 📱 網頁功能說明

### 1. 控制面板
- **開始日期**：選擇對帳開始日期
- **結束日期**：選擇對帳結束日期
- **載入資料**：載入並顯示營業統計資料
- **生成報告**：生成對帳報告
- **下載報告**：下載 Excel 格式報告

### 2. 營業統計摘要
顯示以下統計資訊：
- 總營業額
- 現金總額
- 刷卡總額
- 文化幣總額
- 其他總額
- 營業天數
- 平均每日營業額
- 現金佔比
- 刷卡佔比

### 3. 每日營業摘要
按日期顯示每日的：
- 營業總額
- 現金收入
- 刷卡收入
- 文化幣收入
- 其他收入

### 4. 付款方式摘要
分析各種付款方式的：
- 總金額
- 平均每日金額

### 5. 員工營業摘要
按員工統計：
- 總營業額
- 平均營業額
- 工作天數

## 🔧 命令列使用方式

### 測試模式（不需要 Google API）
```bash
python test_revenue_system.py
```

### 實際對帳（需要 Google API）
```bash
# 測試實際資料
python revenue_main.py --mode test

# 手動對帳（最近兩週）
python revenue_main.py --mode manual

# 指定日期範圍對帳
python revenue_main.py --mode manual --start-date 2025-04-29 --end-date 2025-05-12
```

## 📊 系統特色

1. **自動化分析**：自動計算各種營業統計
2. **多維度分析**：按日期、員工、付款方式分析
3. **視覺化展示**：網頁介面提供直觀的資料展示
4. **報告生成**：自動生成 Excel 和文字報告
5. **即時更新**：支援即時載入和更新資料

## 🚀 快速開始

1. **啟動網頁介面**：
   ```bash
   python start_web.py
   ```

2. **在瀏覽器中操作**：
   - 選擇日期範圍
   - 點擊「載入資料」
   - 查看統計結果
   - 生成和下載報告

3. **停止服務**：
   - 在終端機按 `Ctrl+C`

## 📁 檔案結構

```
雞排自動結帳/
├── web_interface.py          # 網頁介面主程式
├── start_web.py              # 網頁啟動腳本
├── revenue_main.py           # 命令列主程式
├── test_revenue_system.py    # 測試工具
├── revenue_calculator.py     # 營業計算器
├── revenue_report_generator.py # 報告生成器
├── config.py                 # 設定檔
├── templates/
│   └── index.html            # 網頁模板
├── reports/                  # 報告輸出目錄
└── 使用說明.md               # 本說明文件
```

## ❓ 常見問題

### Q: 網頁無法開啟怎麼辦？
A: 檢查端口 8080 是否被佔用，或嘗試重新啟動服務

### Q: 如何修改 Google Sheet 設定？
A: 編輯 `config.py` 檔案中的 `GOOGLE_SHEETS_CONFIG` 設定

### Q: 如何添加新的分析功能？
A: 修改 `revenue_calculator.py` 中的計算邏輯

### Q: 如何自訂報告格式？
A: 修改 `revenue_report_generator.py` 中的報告生成邏輯

## 🆘 技術支援

如有問題或建議，請聯繫開發團隊或查看系統日誌檔案。



